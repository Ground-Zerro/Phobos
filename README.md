# Phobos

Автоматизация развертывания защищенного WireGuard VPN с обфускацией трафика через `wg-obfuscator`.

## Описание

**Phobos** автоматизирует настройку обфусцированного WireGuard соединения между VPS сервером и клиентскими роутерами (Entware).

### Ключевые особенности

- Случайная генерация UDP порта для obfuscator (10000-60000)
- Использование готовых оптимизированных бинарников wg-obfuscator для всех поддерживаемых архитектур
- Автоматическое определение архитектуры роутера и выбор правильного бинарника
- Управление через итерактивное меню (VPS)

## Быстрый старт

### 1. Установка на VPS

Запустите установку:

```bash
bash -c "$(curl -fsSL https://raw.githubusercontent.com/Ground-Zerro/Phobos/main/phobos-deploy.sh)" </dev/tty
```

Система выполнит:
- Проверку и установку необходимых системных зависимостей
- Копирование готовых бинарников wg-obfuscator для VPS сервера и всех поддерживаемых архитектур роутеров (mipsel, mips, aarch64)
- Создание и настройку конфигурационных файлов для WireGuard и obfuscator
- Создание первого клиента
- Генерацию установочного пакета с бинарниками и конфигурациями
- Запуск HTTP-сервера для раздачи установочных пакетов
- Генерацию одноразовой команды установки с уникальным токеном
- Вывод готовой HTTP-ссылки для установки на роутере Keenetic

### 2. Установка на роутер Keenetic

Отправьте ссылку клиенту, он выполняет ее на роутере в терминале (Entware), пример:

```bash
wget -O - http://<server_ip>:8080/init/<token>.sh | sh
```

Скрипт:
- Скачает установочный пакет
- Определит архитектуру роутера
- Установит правильный бинарник wg-obfuscator
- Настроит автозапуск obfuscator
- Настроит WireGuard через RCI API
- Создаст интерфейс "Phobos-{client_name}"
- Активирует подключение
- Проверит handshake

## Интерактивное меню управления

Система включает интерактивное меню управления.

Меню на VPS вызывается командой:
```
phobos
```

**Основные возможности меню:**
- Управление сервисами (start/stop/status/logs для WireGuard, obfuscator, HTTP сервера)
- Управление клиентами (создание, удаление, пересоздание конфигураций)
- Системные функции (health checks, мониторинг клиентов, очистка токенов)
- Резервное копирование конфигураций
- Настройка параметров obfuscator

## Удаление

Для полного удаления Phobos с VPS сервера:

```bash
sudo /opt/Phobos/repo/server/scripts/vps-uninstall.sh
```

Для сохранения резервной копии данных клиентов:

```bash
sudo /opt/Phobos/repo/server/scripts/vps-uninstall.sh --keep-data
```

## License

This project is licensed under GPL-3.0.
See the [LICENSE](./LICENSE) file for full terms.

## Благодарности

- [ClusterM/wg-obfuscator](https://github.com/ClusterM/wg-obfuscator) — инструмент обфускации WireGuard трафика /[Поблагадарить Алексея и поддержать его разработку](https://boosty.to/cluster)/
- [WireGuard](https://www.wireguard.com/) — современный VPN протокол

## Поддержка

**Угостить автора чашечкой какао можно на** [Boosty](https://boosty.to/ground_zerro) ❤️
